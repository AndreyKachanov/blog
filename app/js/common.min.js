$(document).ready(function(){if($("#form_login").submit(function(){var a=$(this),s=!1;if(a.find("input").each(function(){$(this).val().trim()?($(this).removeClass("is-invalid"),$(this).next().css("display","none").html("")):(s=!0,$(this).addClass("is-invalid"),$(this).next().css("display","block").html("Заполните поле."),$("#error-auth").css("display","none").html(""))}),!s){var t=a.serialize();$.ajax({type:"POST",url:"/auth/login/",dataType:"json",data:t,beforeSend:function(s){a.find('button[type="submit"]').attr("disabled","disabled")},success:function(a){if("bad"==a.type)$("#error-auth").css("display","block").html("Неверный логин или пароль!");else if("good"==a.type){$(location).attr("href","/")}},error:function(a,s,t){alert(a.status),alert(t)},complete:function(s){a.find('button[type="submit"]').prop("disabled",!1)}})}return!1}),$("#form_reg").submit(function(){var a=$(this),s=0;!function(a){return new RegExp(/^[a-zA-Z0-9]{3,10}$/).test(a)}($("#login").val())?(s=1,$("#login").addClass("is-invalid"),$("#login").next().css("display","block").html("Логин должен состоять из латинских символов и цифр, содежрать от 3 до 10 символов")):($("#login").removeClass("is-invalid"),$("#login").addClass("is-valid"),$("#login").next().css("display","none").next().empty()),!function(a){return new RegExp(/^[А-Яа-я]+$/).test(a)}($("#name").val())?(s=2,$("#name").addClass("is-invalid"),$("#name").next().css("display","block").html("Имя должно состоять из русских букв, без пробелов.")):($("#name").removeClass("is-invalid"),$("#name").addClass("is-valid"),$("#name").next().css("display","none").next().empty());var t=$("#password").val();if(function(a){return new RegExp(/(?=^.{5,}$)((?=.*\d)|(?=.*\W+))(?![.\n])(?=.*[A-Z])(?=.*[a-z]).*$/).test(a)}(t)){var n=t;$("#password").removeClass("is-invalid"),$("#password").addClass("is-valid"),$("#password").next().css("display","none").next().empty()}else s=3,$("#password").addClass("is-invalid"),$("#password").next().css("display","block").html("Пароль должен состоять из строчных и прописных латинских букв, цифр, спецсимволов. Минимум 5 символов.");$("#password_confirm").val()!=n?(s=4,$("#password_confirm").addClass("is-invalid"),$("#password_confirm").next().css("display","block").html("Подтверждение не совпадает с паролем.")):($("#password_confirm").removeClass("is-invalid"),$("#password_confirm").addClass("is-valid"),$("#password_confirm").next().css("display","none").next().empty());var i=$("#captcha").val();return""==i?(s=5,$("#captcha").addClass("is-invalid"),$("#captcha").next().css("display","block").html("Введите капчу.")):function(a,s){var t=s||function(){};$.ajax({type:"POST",url:"/auth/captcha/",dataType:"json",data:{captcha:a},success:function(a){t(a)},error:function(a,s,t){alert(a.status),alert(t)}})}(i,function(t){if("bad"==t.type)console.log("Bad!!!!!"),console.log("error в bad = "+s),$("#captcha").addClass("is-invalid"),$("#captcha").next().css("display","block").html("Неверный код капчи. JS");else if($("#captcha").removeClass("is-invalid"),$("#captcha").addClass("is-valid"),$("#captcha").next().css("display","none").next().empty(),console.log("Good!!!!"),console.log("error в good = "+s),0==s){var n=a.serialize();$.ajax({type:"POST",url:"/auth/register/",dataType:"json",data:n,beforeSend:function(s){a.find('button[type="submit"]').attr("disabled","disabled")},success:function(a){"bad"==a.type?($("#login").removeClass("is-valid"),$("#login").addClass("is-invalid"),$("#login").next().css("display","block").html("Данный логин уже занят JS.")):"good"==a.type&&($("#register").remove(),$("#content").append('<div class="main succ_register"><h2>Вы удачно зарегистрировались!</h2><p>После активации вашей учетной записи Вы сможете зайти на сайт. Ожидайте...</p></div>'))},error:function(a,s,t){alert(a.status),alert(t),alert("test")},complete:function(s){a.find('button[type="submit"]').prop("disabled",!1)}})}}),!1}),$('<button type="button" class="btn btn-outline-secondary"><i class="fa fa-refresh" aria-hidden="true"></i></button>').appendTo("#append").click(function(){$("#captcha_reload").attr("src","/imgcaptcha.php?"+Math.random())}),$('<button type="button" class="btn btn-outline-secondary"><i class="fa fa-refresh" aria-hidden="true"></i></button>').insertAfter("#captcha_comments").click(function(){$("#captcha_comments").attr("src","/imgcaptcha.php?"+Math.random())}),$("#my-menu").length){$("#my-menu").mmenu({extensions:["theme-dark","fx-menu-zoom","pagedim-black"],navbar:{title:"Консоль:"},offCanvas:{position:"left"}});var a=$("#my-menu").data("mmenu");a.bind("open:finish",function(){$(".hamburger").addClass("is-active")}),a.bind("close:finish",function(){$(".hamburger").removeClass("is-active")})}$(window).scroll(function(){$(this).scrollTop()>$(this).height()?$(".top").addClass("active"):$(".top").removeClass("active")}),$(".top").click(function(){$("html, body").stop().animate({scrollTop:0},"slow","swing")})}),$(window).on("load",function(){$(".preloader").delay(300).fadeOut("slow")});